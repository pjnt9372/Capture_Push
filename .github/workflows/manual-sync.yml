name: manual-sync

on:
  workflow_dispatch:
    inputs:
      note:
        description: 'å¤‡æ³¨'
        default: 'æ‰‹åŠ¨è§¦å‘åŒæ­¥'

jobs:
  sync-folder:
    runs-on: ubuntu-latest
    steps:
      # ç¬¬ä¸€æ­¥ï¼šæ£€å‡ºæºä»“åº“ä»£ç 
      - name: ğŸ›ï¸ æ£€å‡ºæºä»“åº“
        uses: actions/checkout@v4

      # ç¬¬äºŒæ­¥ï¼šæ£€å‡ºç›®æ ‡ä»“åº“ (å…³é”®ä¿®å¤ç‚¹)
      - name: ğŸ—‚ï¸ æ£€å‡ºç›®æ ‡ä»“åº“
        uses: actions/checkout@v4
        with:
          # ğŸ‘‡ æŒ‡å®šç›®æ ‡ä»“åº“åœ°å€
          repository: pjnt9372/Capture_Push_Plugin
          # ğŸ‘‡ æŒ‡å®šåˆ†æ”¯
          ref: master
          # ğŸ‘‡ å°†ç›®æ ‡ä»“åº“å…‹éš†åˆ° local-target ç›®å½•
          path: target-repo
          # ğŸ‘‡ æ ¸å¿ƒä¿®å¤ï¼šæ˜¾å¼ä¼ å…¥ Token è¿›è¡Œè®¤è¯
          token: ${{ secrets.ACCESS_TOKEN }}

      # ç¬¬ä¸‰æ­¥ï¼šå¤åˆ¶æ–‡ä»¶
      - name: ğŸ“‚ å¤åˆ¶æ–‡ä»¶åˆ°ç›®æ ‡ç›®å½•
        run: |
          # æ£€æŸ¥æºæ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨
          if [ ! -d "developer_space" ]; then
            echo "é”™è¯¯ï¼šæºä»“åº“ä¸­ä¸å­˜åœ¨ developer_space æ–‡ä»¶å¤¹"
            exit 1
          fi
          
          # æ¸…ç©ºç›®æ ‡ç›®å½•ä¸‹çš„ developer_space æ–‡ä»¶å¤¹å†…å®¹
          rm -rf target-repo/developer_space/*
          
          # å°†æºä»“åº“çš„æ–‡ä»¶å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•çš„ developer_space æ–‡ä»¶å¤¹ä¸­
          cp -r developer_space/* target-repo/developer_space/
          
          # æŸ¥çœ‹å¤åˆ¶äº†å“ªäº›æ–‡ä»¶ï¼ˆç”¨äºè°ƒè¯•ï¼‰
          echo "å‡†å¤‡æ¨é€çš„æ–‡ä»¶åˆ—è¡¨ï¼š"
          ls -la target-repo/developer_space/

      # ç¬¬å››æ­¥ï¼šæ¨é€å›ç›®æ ‡ä»“åº“
      - name: ğŸš€ æ¨é€æ›´æ–°
        uses: ad-m/github-push-action@master
        with:
          # ğŸ‘‡ æŒ‡å‘æˆ‘ä»¬åˆšæ‰ä¿®æ”¹çš„ target-repo ç›®å½•
          directory: target-repo
          # ğŸ‘‡ æ¨é€åˆ°ç›®æ ‡ä»“åº“çš„ master åˆ†æ”¯
          branch: master
          # ğŸ‘‡ ä½¿ç”¨ Token æ¨é€
          token: ${{ secrets.ACCESS_TOKEN }}
          commit_message: Update developer_space files
